<!DOCTYPE html>
<html><head>
<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../icon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-82b1a03c67a08b47b550cf05f64695ee.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
      "location": "sidebar",
      "copy-button": false,
      "collapse-after": 3,
      "panel-placement": "start",
      "type": "textbox",
      "limit": 50,
      "keyboard-shortcut": [
        "f",
        "/",
        "s"
      ],
      "show-item-context": false,
      "language": {
        "search-no-results-text": "No results",
        "search-matching-documents-text": "matching documents",
        "search-copy-link-title": "Copy link to search",
        "search-hide-matches-text": "Hide additional matches",
        "search-more-match-text": "more match in this document",
        "search-more-matches-text": "more matches in this document",
        "search-clear-button-title": "Clear",
        "search-text-placeholder": "",
        "search-detached-cancel-button-title": "Cancel",
        "search-submit-button-title": "Submit",
        "search-label": "Search"
      }
    }</script><script>

      window.document.addEventListener("DOMContentLoaded", function (_event) {
        const listingTargetEl = window.document.querySelector('#listing-posts-pibic .list');
        if (!listingTargetEl) {
          // No listing discovered, do not attach.
          return; 
        }

        const options = {
          valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
          
          searchColumns: [],
        };

        window['quarto-listings'] = window['quarto-listings'] || {};
        window['quarto-listings']['listing-posts-pibic'] = new List('listing-posts-pibic', options);

        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      });

      window.addEventListener('hashchange',() => {
        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      })
      

      window.document.addEventListener("DOMContentLoaded", function (_event) {
        const listingTargetEl = window.document.querySelector('#listing-posts-linux .list');
        if (!listingTargetEl) {
          // No listing discovered, do not attach.
          return; 
        }

        const options = {
          valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
          
          searchColumns: [],
        };

        window['quarto-listings'] = window['quarto-listings'] || {};
        window['quarto-listings']['listing-posts-linux'] = new List('listing-posts-linux', options);

        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      });

      window.addEventListener('hashchange',() => {
        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      })
      

      window.document.addEventListener("DOMContentLoaded", function (_event) {
        const listingTargetEl = window.document.querySelector('#listing-posts-computacao .list');
        if (!listingTargetEl) {
          // No listing discovered, do not attach.
          return; 
        }

        const options = {
          valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
          
          searchColumns: [],
        };

        window['quarto-listings'] = window['quarto-listings'] || {};
        window['quarto-listings']['listing-posts-computacao'] = new List('listing-posts-computacao', options);

        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      });

      window.addEventListener('hashchange',() => {
        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      })
      

      window.document.addEventListener("DOMContentLoaded", function (_event) {
        const listingTargetEl = window.document.querySelector('#listing-posts-biomol .list');
        if (!listingTargetEl) {
          // No listing discovered, do not attach.
          return; 
        }

        const options = {
          valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
          
          searchColumns: [],
        };

        window['quarto-listings'] = window['quarto-listings'] || {};
        window['quarto-listings']['listing-posts-biomol'] = new List('listing-posts-biomol', options);

        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      });

      window.addEventListener('hashchange',() => {
        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      })
      

      window.document.addEventListener("DOMContentLoaded", function (_event) {
        const listingTargetEl = window.document.querySelector('#listing-posts-estatistica .list');
        if (!listingTargetEl) {
          // No listing discovered, do not attach.
          return; 
        }

        const options = {
          valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
          
          searchColumns: [],
        };

        window['quarto-listings'] = window['quarto-listings'] || {};
        window['quarto-listings']['listing-posts-estatistica'] = new List('listing-posts-estatistica', options);

        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      });

      window.addEventListener('hashchange',() => {
        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      })
      

      window.document.addEventListener("DOMContentLoaded", function (_event) {
        const listingTargetEl = window.document.querySelector('#listing-posts-filosofia .list');
        if (!listingTargetEl) {
          // No listing discovered, do not attach.
          return; 
        }

        const options = {
          valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
          
          searchColumns: [],
        };

        window['quarto-listings'] = window['quarto-listings'] || {};
        window['quarto-listings']['listing-posts-filosofia'] = new List('listing-posts-filosofia', options);

        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      });

      window.addEventListener('hashchange',() => {
        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      })
      

      window.document.addEventListener("DOMContentLoaded", function (_event) {
        const listingTargetEl = window.document.querySelector('#listing-posts-neurociencia .list');
        if (!listingTargetEl) {
          // No listing discovered, do not attach.
          return; 
        }

        const options = {
          valueNames: [{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
          
          searchColumns: [],
        };

        window['quarto-listings'] = window['quarto-listings'] || {};
        window['quarto-listings']['listing-posts-neurociencia'] = new List('listing-posts-neurociencia', options);

        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      });

      window.addEventListener('hashchange',() => {
        if (window['quarto-listing-loaded']) {
          window['quarto-listing-loaded']();
        }
      })
      </script><link rel="stylesheet" href="../../../cyanobacteria.css">
    <title>Odeio regiões duplicadas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
</head>
<body class="fullcontent quarto-light">
    <div class="container">
        <header>
            <span>Odeio regiões duplicadas</span>
        </header>
        <div class="small">
            <nav>
                <div>Navegação</div>
                <a href="../../../index.html">Início</a>
                <a href="../../../posts.html">Posts</a>
                <a href="../../../curriculum.html">Currículo</a>
                <a href="../../../about.html">Sobre</a>
            </nav>
        </div>
        <section class="large">
            <p><strong>Introdução</strong></p>
            <p>Recentemente, comecei a ter alguns problemas na minha montagem, por se tratar de um genoma complexo (tetraploíde), ou seja, varias regiões repetitivas e heterozigotas. Quando terminei minha montagem primária pelo Hifiasm, notei que o tamanho do arquivo estava bem maior do que o esperado (Resultados de citometro mostrando o tamanho do gênoma). O esperado era ~1,4 Gb, porém, o Hifiasm me devolveu um resultado de 2,4 Gb. Quase 1 Gb do que o esperado. Mas o que é essa informação? Como saber qual região foi processada errado.</p>
            <hr>
            <p><strong>Purge</strong></p>
            <p>Vamos elucidar essas problemáticas.</p>
            <p>Primeiro ponto é a montagem do Hifiasm é feita de maneira linear em regiões homozigotas, ou seja, ele colapsa as regiões cromossomicas dos haplotipos, quando a informação contida neles é a mesma. O problema está justamente nas regiões não homozigotas. Na qual o software cria o que chamamos de “bolha”, explico um pouco melhor no post do Hifiasm.</p>
            <p>Como devem imaginar isso faz surgir algumas problemáticas, a principal dessa problemáticas é duplicação de regiões que teoricamente seriam do mesmo haplotipo, e o software interpreta como duas regiões diferentes. Isso explica o motivo do arquivo ser bem maior do que o esperado. O hifiasm tem um mecanismo de purge nativo capaz de lidar com esse tipo de duplicação.</p>
            <p>Mas em casos de genomas mais complexos como o meu, esse mecanismo pode não ser tão eficiente assim, já que o software é modelado para organismos diplóides. Então para sanar essa problemática, utilizei outro software especializado em Purges. (Purge_dups).</p>
            <hr>
            <p><strong>Purge_dups</strong></p>
            <p>Beleza, então conseguimos aumentar a qualidade da nossa montagem?</p>
            <p>O purge_dups deu muito trabalho, primeiramente na primeira parte que temos que alinhar nossa sequencia (com alguma outra de referencia ou contra o própio resultado do sequenciamento bruto) usando um software chamado (Minimap2).</p>
            <p>Porém essa simples etapa levou cerca de duas semanas, não estava conseguindo gerar os outputs necessarios para seguir com o purged_dups, revi 1 milhão de vezes o README do purge_dups, revisei todos os passos varias vezes, e ainda sim, só consegui achar a resposta quando fui entender o minimap2 a fundo. Percebi que o uso de um dos parametros que o purge_dups indicava para essa etapa de alinhamento estava incorreto, fazendo o minimap2 não funcionar da maneira esperada. Contactei o dev para relatar o problema, após utilizar outro parametro e conseguir seguir com o purge.</p>
            <p><img src="images/clipboard-3800598797.png" class="img-fluid" width="783"></p>
            <p>A resposta foi quase imediata, e logo após isso o dev consertou o parametro para outros usuarios não terem o mesmo problema que eu tive. Após conseguir rodar gerei um arquivo output sem essas sequencias duplicadas. Mas o problema não acabou ai, o arquivo (purged.fa) que é esse arquivo de saída comentado acima, veio com um tamanho de ~1,1Gb. Cerca de 400Mb abaixo do que eu esperava, ou seja, o purge_dups funcionou, mas cortou regiões que não era pra ter cortado. E agora?</p>
            <p><strong>Continuação purge_dups</strong></p>
            <p>Então, foi bem frustante a principio quando notei que o software tinha rodado errado. Mas de certo modo, desafiador também. Comecei a rever todos os parametros e outputs, analisando todas as contigs que foram removidas tentando achar esses fragmentos de sequencia que foram retirados erroneamente. Meu orientador deu a ideia de rodarmos o purge para cada um dos haplotipos gerados na montagem do Hifiasm, inves de rodar a montagem primaria completa. Começamos fazendo isso, e o arquivo gerado no hap1 teve o mesmo problema do corte excessivo. Então decidi, rever e procurar papers que poderiam me ajudar a entender como rodar o software melhor para um genoma complexo como o meu.</p>
            <p>Foi quando eu percebi que se eu ajustasse o arquivo de cutoffs eu iria estar manualmente forçando o software a interpretar apenas a região de cobertura que eu quisesse, então eu e meu orientador partimos nessa jornada de luta contra a maquina.</p>
            <p>Primeira coisa que percebemos foi que no histograma inicial, ele interpretava os picos de uma maneira estranha, dando valores númericos não tão condizentes com a região analisada. Percebemos que o problema era exatamente nesse parametro que trata dos picos (mid-coverage).</p>
            <p>Então decidimos ir ajustando até acharmos a região que nos retornaria um arquivo com aproximadamente o tamanho esperado (~1,4Gb). Isso foi um processo longo também, cada tentativa demandava ~30 minutos e não sabiamos se o resultado iria ser o favoravel.</p>
            <p>Para isso, jogamos alguns valores para entender melhor como funcionava o comportamento da reta.</p>
            <p>Percebemos que a inclinação da reta era oposta ao valor numerico que colocavamos. Ou seja, quanto maior o valor numérico maior a area que o software vai interpretar que pode haver duplicações, logo, o tamanho do nosso arquivo era menor. Achamos o valor ideal ajustando o parametro no 77 para mid-coverage.</p>
            <hr>
            <p><strong>Resultados</strong></p>
            <p>Então depois de todas essas problematicas sanadas, conseguimos elevar a qualidade da montagem, e gerar os arquivos que vão dar sequencia a nossa montagem.</p>
            <p><img src="images/clipboard-3350166681.png" class="img-fluid"></p>
            <p><strong>Histograma</strong></p>
            <p><img src="images/clipboard-2151146867.png" class="img-fluid"></p>
            <p>Podemos notar no grafíco três linhas que representam os três parametros utilizados no cutoff para o purge.</p>
            <p>5 (low-coverage): Tudo que tem uma cobertura menor que 5 é definido com Junk e essa sequencia é discartada. 77 (mid-coverage): Gera esse intervalo entre picos, que representam a área que deve ser ánalisada para buscar sequencias repetitivas. 338 (high-coverage): Regiões extremamentes repetitivas, podem ser regiões centromericas ou regiões proximas ao telomero (extremidade cromossomal).</p>
            <hr>
            <p><strong>Next caps</strong></p>
            <p>Partimos para os proximos softwares (BUSCO, KRAKEN2)! e trarei atualizações no Jomaserver!</p>
            <p>BUSCO: Fará um mapa de genes tornando ainda mais lúcida a avalição da montagem. KRAKEN2: Fará uma ánalise metagenomica encontrando contaminantes (Sequencias de outros organismos) que estão presentes no meus dados de sequenciamento.</p>
            <p>Abraço.</p>
            
            
            
        </section>
    </div>
    <footer>
        <span>Jomaserver Blog by <a href="https://jomaserver.github.io/posts.html">João Marcelo</a></span>
    </footer>
    

<div class="quarto-listing quarto-listing-container-default" id="listing-posts-pibic">
            <div class="list quarto-listing-default">

            </div>
            <div class="listing-no-matching d-none">No matching items</div>
            </div><div class="quarto-listing quarto-listing-container-default" id="listing-posts-linux">
            <div class="list quarto-listing-default">

            </div>
            <div class="listing-no-matching d-none">No matching items</div>
            </div><div class="quarto-listing quarto-listing-container-default" id="listing-posts-computacao">
            <div class="list quarto-listing-default">

            </div>
            <div class="listing-no-matching d-none">No matching items</div>
            </div><div class="quarto-listing quarto-listing-container-default" id="listing-posts-biomol">
            <div class="list quarto-listing-default">

            </div>
            <div class="listing-no-matching d-none">No matching items</div>
            </div><div class="quarto-listing quarto-listing-container-default" id="listing-posts-estatistica">
            <div class="list quarto-listing-default">

            </div>
            <div class="listing-no-matching d-none">No matching items</div>
            </div><div class="quarto-listing quarto-listing-container-default" id="listing-posts-filosofia">
            <div class="list quarto-listing-default">

            </div>
            <div class="listing-no-matching d-none">No matching items</div>
            </div><div class="quarto-listing quarto-listing-container-default" id="listing-posts-neurociencia">
            <div class="list quarto-listing-default">

            </div>
            <div class="listing-no-matching d-none">No matching items</div>
            </div></body></html>